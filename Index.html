<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zelvora ‚Äì Secure AI Coach</title>
  <style>
    :root {
      --bg: #f6f7fb; --primary: #0c2340; --accent: #1f7aff; --text: #111827;
      --muted: #6b7280; --card: #ffffff; --radius-pill: 999px;
    }
    body { font-family: system-ui, sans-serif; background: var(--bg); color: var(--text); padding: 20px; }
    .page { max-width: 800px; margin: 0 auto; }
    .ai-section { background: var(--primary); color: white; padding: 30px; border-radius: 28px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
    #chat-output { background: rgba(255,255,255,0.05); padding: 20px; border-radius: 18px; min-height: 150px; margin-bottom: 20px; overflow-y: auto; max-height: 400px; }
    .input-group { display: flex; gap: 10px; background: white; padding: 8px; border-radius: var(--radius-pill); }
    input { flex: 1; border: none; outline: none; padding: 0 15px; font-size: 14px; }
    .btn { padding: 10px 20px; border-radius: var(--radius-pill); border: none; cursor: pointer; font-weight: 600; background: var(--accent); color: white; }
    .btn:disabled { background: var(--muted); cursor: not-allowed; }
    .thinking { opacity: 0.6; font-style: italic; font-size: 13px; margin-top: 5px; }
  </style>
</head>
<body>
  <div class="page">
    <section class="ai-section">
      <h2>Zelvora AI Coach</h2>
      <div id="chat-output">System: Secure Firebase Tunnel Initialized. Ready for questions.</div>

      <div class="input-group">
        <input type="text" id="user-input" placeholder="Ask about business or academics...">
        <button id="send-btn" class="btn">Send</button>
      </div>
      <div id="status" class="thinking" style="display:none;">Zelvora is processing...</div>
    </section>
  </div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
  import { getAI, getGenerativeModel } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-ai.js";

  const firebaseConfig = {
    apiKey: "AIzaSy...", 
    authDomain: "zelvora-global.firebaseapp.com",
    projectId: "zelvora-global",
    appId: "1:123456789:web:abcdef"
  };

  // ‚úÖ Initialize Firebase
  const app = initializeApp(firebaseConfig);

  // ‚úÖ FORCE FREE TIER (VERY IMPORTANT)
  const ai = getAI(app, { backend: "google-ai" });

  // ‚úÖ Free 2026 model
  const model = getGenerativeModel(ai, {
    model: "gemini-3-flash-preview"
  });

  const output = document.getElementById("chat-output");
  const userInput = document.getElementById("user-input");
  const sendBtn = document.getElementById("send-btn");
  const status = document.getElementById("status");

  async function handleChat() {
    const prompt = userInput.value.trim();
    if (!prompt) return;

    output.innerHTML += `<div style="color:#9ca3af;"><b>You:</b> ${prompt}</div>`;
    userInput.value = "";
    sendBtn.disabled = true;
    status.style.display = "block";

    try {
      const result = await model.generateContent(prompt);
      const text = result.response.text();

      output.innerHTML += `<div><b>Zelvora:</b> ${text}</div>`;
    } catch (err) {
      console.error(err);
      output.innerHTML += `<div style="color:#ff4d4d;">‚ùå AI not connected</div>`;
    } finally {
      sendBtn.disabled = false;
      status.style.display = "none";
      output.scrollTop = output.scrollHeight;
    }
  }

  sendBtn.onclick = handleChat;
  userInput.addEventListener("keydown", e => {
    if (e.key === "Enter") handleChat();
  });

  // üî• AUTO CONNECTION TEST (runs once)
  (async () => {
    try {
      const r = await model.generateContent("Reply only with CONNECTED");
      output.innerHTML += `<div style="color:#10b981;"><b>System:</b> ${r.response.text()}</div>`;
    } catch {
      output.innerHTML += `<div style="color:#ff4d4d;"><b>System:</b> AI NOT CONNECTED</div>`;
    }
  })();
</script>
</body>
</html>
