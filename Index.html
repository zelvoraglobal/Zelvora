<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zelvora ‚Äì AI Coaching & Business Growth</title>
  <style>
    :root {
      --bg: #f6f7fb; --primary: #0c2340; --accent: #1f7aff; --text: #111827;
      --muted: #6b7280; --card: #ffffff; --border: #e5e7eb; --radius-pill: 999px;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: system-ui, sans-serif; background: var(--bg); color: var(--text); }
    .page { max-width: 1120px; margin: 0 auto; padding: 22px 16px; }
    
    /* Header & Hero Styles from your code... */
    header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 26px; }
    .logo-icon { width: 40px; height: 40px; border-radius: 14px; background: var(--primary); color: #fff; display: flex; align-items: center; justify-content: center; font-weight: 800; }
    
    /* AI Coach Box */
    .ai-section {
      background: var(--primary); color: white; padding: 30px; border-radius: 28px;
      box-shadow: 0 18px 40px rgba(15,23,42,0.15); margin: 30px 0;
    }
    #chat-output {
      background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
      padding: 20px; border-radius: 18px; min-height: 120px; margin-bottom: 20px;
      font-size: 15px; line-height: 1.6;
    }
    .input-group {
      display: flex; gap: 10px; background: white; padding: 8px; border-radius: var(--radius-pill);
    }
    input { flex: 1; border: none; outline: none; padding: 0 15px; font-size: 14px; }
    .btn { padding: 10px 20px; border-radius: var(--radius-pill); border: none; cursor: pointer; font-weight: 600; }
    .btn-primary { background: var(--accent); color: white; }
    .btn-mic { background: #f3f4f6; font-size: 20px; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div style="display:flex; align-items:center; gap:12px;">
        <div class="logo-icon">Z</div>
        <div style="font-weight:700; letter-spacing:.08em;">ZELVORA</div>
      </div>
    </header>

    <section class="ai-section">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
        <h2>Zelvora AI Coach</h2>
        <span id="status" style="font-size:11px; opacity:0.7;">‚óè Online</span>
      </div>
      
      <div id="chat-output">"Hello! I am your Zelvora Coach. Tap the mic to practice English or type a business question."</div>

      <div class="input-group">
        <button id="mic-btn" class="btn-mic">üé§</button>
        <input type="text" id="user-input" placeholder="Ask about English fluency or Academics...">
        <button id="send-btn" class="btn btn-primary">Send</button>
      </div>
    </section>

    </div>

  <script type="importmap">
    { "imports": { "@google/generative-ai": "https://esm.run/@google/generative-ai" } }
  </script>

  <script type="module">
    import { GoogleGenerativeAI } from "@google/generative-ai";

    // 1. CONFIGURATION (Replace with your Key)
    const API_KEY = "AIzaSyDpueYhA7kc3ciwCet51GJv3_qBf4GtEAo";
    const genAI = new GoogleGenerativeAI(API_KEY);
    const model = genAI.getGenerativeModel({ 
      model: "gemini-1.5-flash",
      systemInstruction: "You are the Zelvora Coach. You specialize in Spoken English fluency and Academic growth for Indian entrepreneurs. Keep replies encouraging, short, and use professional English."
    });

    const output = document.getElementById("chat-output");
    const userInput = document.getElementById("user-input");
    const sendBtn = document.getElementById("send-btn");
    const micBtn = document.getElementById("mic-btn");

    // 2. VOICE OUTPUT (Text-to-Speech)
    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-IN'; // Professional Indian English
      utterance.rate = 0.9;
      window.speechSynthesis.speak(utterance);
    }

    // 3. MAIN AI LOGIC
    async function handleRequest() {
      const text = userInput.value.trim();
      if (!text) return;

      output.innerText = "Zelvora is thinking...";
      sendBtn.disabled = true;

      try {
        const result = await model.generateContent(text);
        const responseText = result.response.text();
        
        output.innerText = responseText;
        speak(responseText);
      } catch (err) {
        output.innerText = "Error: Check your API Key or Network.";
      } finally {
        sendBtn.disabled = false;
        userInput.value = "";
      }
    }

    // 4. VOICE INPUT (Speech-to-Text)
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (SpeechRecognition) {
      const recognition = new SpeechRecognition();
      micBtn.onclick = () => {
        recognition.start();
        document.getElementById("status").innerText = "Listening...";
      };
      recognition.onresult = (event) => {
        userInput.value = event.results[0][0].transcript;
        handleRequest();
      };
      recognition.onend = () => { document.getElementById("status").innerText = "‚óè Online"; };
    }

    sendBtn.onclick = handleRequest;
    userInput.addEventListener("keypress", (e) => { if(e.key === "Enter") handleRequest(); });
  </script>
  <script type="module">
  import { askZelvora } from './gemini.js';

  const sendBtn = document.getElementById('sendBtn');
  const userInput = document.getElementById('userInput');
  const chatDisplay = document.getElementById('chatDisplay');

  sendBtn.addEventListener('click', async () => {
    const text = userInput.value;
    if (!text) return;

    // 1. Show User Text
    chatDisplay.innerHTML += `<div class="user-msg">You: ${text}</div>`;
    userInput.value = '';

    // 2. Show "Zelvora is thinking..."
    const loadingId = "loading-" + Date.now();
    chatDisplay.innerHTML += `<div id="${loadingId}" class="ai-msg"><i>Zelvora is thinking...</i></div>`;

    // 3. Call the Brain
    const response = await askZelvora(text);

    // 4. Update UI with Response
    document.getElementById(loadingId).innerHTML = `Zelvora: ${response}`;
    
    // 5. Automatic Voice Response
    speak(response);
  });

  // Simple 2026 Text-to-Speech
  function speak(text) {
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = 'en-US'; // Set to 'en-IN' for an Indian English accent
    window.speechSynthesis.speak(utterance);
  }
</script>

</body>
</html>
